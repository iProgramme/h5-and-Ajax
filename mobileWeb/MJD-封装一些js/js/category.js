window.onload=function(){
    //?????
    swipeLeft();

    //?????
    swipeRight()
}
/*???????
* ????
* 1????? ????
*    ???????li??? ??????
*    ???????li??? ?????????????
*
* 2??????????????
*    2-1???????
*       ??????¶À??
*    2-2???????
*       ??????¶À??
*       ??ul??????????
*    2-3????????
*       ?ßÿ?ul??????????Ì‡?????????????
*
* */
function swipeLeft(){
    var leftBox=document.querySelector('.body-left');
    var ul=leftBox.querySelector('ul');
    var lis=ul.querySelectorAll('li');

    var currentY=0;//???ul?????¶À??
    //-------------------0-????-------------------
    //??¶À????
    var maxTop=0;
    var minTop=leftBox.offsetHeight-ul.offsetHeight;
    //????????
    var maxSwipe=maxTop+120;
    var minSwipe=minTop-120;
    //----------------0-??????????-----------------
    //??????
    var addTransition=function(){
        ul.style.webkitTransition='transform 0.2s';
        ul.style.transition='transform 0.2s';
    }
    //???????
    var removeTransition=function(){
        ul.style.webkitTransition='none';
        ul.style.transition='none';
    }
    //ul¶À??
    var setTranslateY=function(translateY){
        ul.style.webkitTransform='translateY('+translateY+'px)';
        ul.style.transform='translateY('+translateY+'px)';
    }
    //-----------------1-???????--------------------
    itcast.tap(leftBox,function(e){
        //1-1???????li??? ??????
        console.log(e.target.parentNode); //e.target?????????ß≥?????
        var target= e.target.parentNode;//??????????li???
        //????
        for(var i=0;i<lis.length;i++){
            lis[i].classList.remove('current');
            lis[i].index=i; //??????????
        }
        //??????
        target.classList.add('current');
        //1-2???????li??? ????????????? ul¶À??
        /*
        *  0  0
        *  1  -50
        *  2  -100
        *  3  -150  -50*index
        * */
        //¶À??????=-50*index;
        var y=-50*target.index;
        //??????
        if(y>maxTop){
            y=maxTop;
        }

        if(y<minTop){
            y=minTop;
        }
        //??????
        addTransition();
        //ul¶À??
        setTranslateY(y);

        currentY=y; //??????ul??¶À??

    });

    //---------2-??????? ?ß›?????--------------------
    var startY=0;
    var moveY=0;
    var distanceY=0;
    leftBox.addEventListener('touchstart',function(e){
        startY= e.targetTouches[0].clientY;//??????¶À??
    });

    leftBox.addEventListener('touchmove',function(e){
        moveY= e.targetTouches[0].clientY;//??????¶À??
        distanceY=moveY-startY;//????????
        //??ul??????????  ul????????=????¶À??+distanceY;
        var y=currentY+distanceY;
        //??????
        if(y>maxSwipe){
            y=maxSwipe;
        }
        if(y<minSwipe){
            y=minSwipe;
        }
        removeTransition();//???????
        setTranslateY(y);//ul¶À??
    });

    leftBox.addEventListener('touchend',function(){
        //??????????????????ul¶À??
        currentY=currentY+distanceY;
        //?ßÿ???????¶À??????  minTop maxTop
        //?????? ??????????
        //?????
        if(currentY>maxTop){
            currentY=maxTop;
            addTransition(); //??????
            setTranslateY(currentY); //ul¶À??
        }
        if(currentY<minTop){
            currentY=minTop;
            addTransition(); //??????
            setTranslateY(currentY); //ul¶À??
        }



        //????????
        startY=0;
        moveY=0;
        distanceY=0;
    })

}

function swipeRight(){
    var leftBox=document.querySelector('.body-right');
    var ul=leftBox.querySelector('.right-in');


    var currentY=0;//???ul?????¶À??
    //-------------------0-????-------------------
    //??¶À????
    var maxTop=0;
    var minTop=leftBox.offsetHeight-ul.offsetHeight;
    //????????
    var maxSwipe=maxTop+120;
    var minSwipe=minTop-120;
    //----------------0-??????????-----------------
    //??????
    var addTransition=function(){
        ul.style.webkitTransition='transform 0.2s';
        ul.style.transition='transform 0.2s';
    }
    //???????
    var removeTransition=function(){
        ul.style.webkitTransition='none';
        ul.style.transition='none';
    }
    //ul¶À??
    var setTranslateY=function(translateY){
        ul.style.webkitTransform='translateY('+translateY+'px)';
        ul.style.transform='translateY('+translateY+'px)';
    }


    //---------2-??????? ?ß›?????--------------------
    var startY=0;
    var moveY=0;
    var distanceY=0;
    leftBox.addEventListener('touchstart',function(e){
        startY= e.targetTouches[0].clientY;//??????¶À??
    });

    leftBox.addEventListener('touchmove',function(e){
        moveY= e.targetTouches[0].clientY;//??????¶À??
        distanceY=moveY-startY;//????????
        //??ul??????????  ul????????=????¶À??+distanceY;
        var y=currentY+distanceY;
        //??????
        if(y>maxSwipe){
            y=maxSwipe;
        }
        if(y<minSwipe){
            y=minSwipe;
        }
        removeTransition();//???????
        setTranslateY(y);//ul¶À??
    });

    leftBox.addEventListener('touchend',function(){
        //??????????????????ul¶À??
        currentY=currentY+distanceY;
        //?ßÿ???????¶À??????  minTop maxTop
        //?????? ??????????
        //?????
        if(currentY>maxTop){
            currentY=maxTop;
            addTransition(); //??????
            setTranslateY(currentY); //ul¶À??
        }
        if(currentY<minTop){
            currentY=minTop;
            addTransition(); //??????
            setTranslateY(currentY); //ul¶À??
        }



        //????????
        startY=0;
        moveY=0;
        distanceY=0;
    })

}